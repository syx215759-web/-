<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8" />
<title>ä¸­é«˜å¹´ç´šé–±è®€ / è½åŠ›ææ–™</title>

<style>
body {
  font-family: "Noto Sans TC", Arial, sans-serif;
  margin: 0;
  padding: 16px;
  background: #f5f7fb;
}

/* ================= å¡ç‰‡ ================= */

#lesson-list {
  display: flex;
  gap: 16px;
  flex-wrap: wrap;
  justify-content: center;
}

.lesson-card {
  width: 220px;
  background: #fff;
  border-radius: 12px;
  padding: 14px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.06);
  display: flex;
  flex-direction: column;
}

.lesson-icon {
  height: 80px;
  border-radius: 8px;
  background: #eef2f8;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 32px;
  margin-bottom: 10px;
}

.lesson-title {
  font-size: 15px;
  font-weight: 700;
}

.lesson-meta {
  font-size: 13px;
  color: #666;
  margin-bottom: 10px;
}

.lesson-actions {
  margin-top: auto;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.like-btn {
  background: none;
  border: none;
  cursor: pointer;
  font-size: 14px;
  color: #555;
}

.like-btn.liked {
  color: #e63946;
}

/* ================= åˆ†é  ================= */

.pagination {
  margin-top: 32px;
  display: flex;
  justify-content: center;
  gap: 8px;
}

.page-btn {
  border: 1px solid #ccc;
  background: #fff;
  padding: 6px 10px;
  border-radius: 6px;
  cursor: pointer;
}

.page-btn.active {
  background: #3b6cff;
  color: #fff;
  border-color: #3b6cff;
}

/* ================= Modal ================= */

.modal {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.45);
  justify-content: center;
  align-items: center;
  z-index: 999;
}

.modal-content {
  background: #fff;
  width: 90%;
  max-width: 520px;
  border-radius: 14px;
  padding: 22px;
  position: relative;
  max-height: 80vh;
  overflow-y: auto;
}

.close-btn {
  position: absolute;
  top: 10px;
  right: 14px;
  font-size: 22px;
  cursor: pointer;
}

.modal h2 {
  font-size: 18px;
  margin-bottom: 4px;
}

.modal-meta {
  font-size: 13px;
  color: #666;
  margin-bottom: 16px;
}

.modal-section {
  margin-bottom: 18px;
}

.modal-section h4 {
  font-size: 14px;
  margin-bottom: 6px;
}

.modal-section ul {
  padding-left: 18px;
  margin: 0;
  font-size: 14px;
}

.read-btn {
  width: 100%;
  margin-top: 10px;
  padding: 10px;
  background: #3b6cff;
  color: #fff;
  border: none;
  border-radius: 8px;
  cursor: pointer;
}

/* ================= ç•™è¨€æµ®å‹•æŒ‰éˆ• ================= */

#commentFab {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  background: #3b6cff;
  color: #fff;
  border: none;
  border-radius: 50%;
  width: 56px;
  height: 56px;
  font-size: 24px;
  cursor: pointer;
  box-shadow: 0 6px 16px rgba(0,0,0,0.25);
  z-index: 1000;
}
</style>
</head>

<body>

<h2 style="text-align:center;">ä¸­é«˜å¹´ç´šé–±è®€ / è½åŠ›ææ–™</h2>

<!-- æœå°‹ -->
<input id="keyword" placeholder="è¼¸å…¥æ¨™é¡Œé—œéµå­—"
  onkeydown="if(event.key==='Enter') handleSearch()" />

<!-- å¡ç‰‡ -->
<div id="lesson-list"></div>
<div id="pagination" class="pagination"></div>

<!-- é è¦½ Modal -->
<div id="previewModal" class="modal">
  <div class="modal-content">
    <span class="close-btn" onclick="closePreview()">Ã—</span>
    <h2 id="modalTitle"></h2>
    <div class="modal-meta" id="modalMeta"></div>

    <div class="modal-section">
      <h4>æš–èº«å•é¡Œ</h4>
      <ul id="modalWarmup"></ul>
    </div>

    <div class="modal-section">
      <h4>é–±è®€ç†è§£</h4>
      <ul id="modalReading"></ul>
    </div>

    <div class="modal-section">
      <h4>è¨è«–å•é¡Œ</h4>
      <ul id="modalDiscussion"></ul>
    </div>

    <div class="modal-section">
      <h4>ç”Ÿè©ï¼ˆå‰ 10ï¼‰</h4>
      <ul id="modalVocab"></ul>
    </div>

    <button class="read-btn" id="readFullBtn">é–±è®€å…¨æ–‡</button>

    <!-- ç•™è¨€å€ -->
    <div class="modal-section" id="commentSection">
      <h4>ç•™è¨€</h4>
      <ul id="commentList"></ul>
      <textarea id="commentInput"
        placeholder="ç•™ä¸‹ä½ çš„æƒ³æ³•â€¦"
        style="width:100%;box-sizing:border-box;padding:8px;"></textarea>
      <button class="read-btn" onclick="addComment()">é€å‡ºç•™è¨€</button>
    </div>
  </div>
</div>

<!-- ç•™è¨€æµ®å‹•æŒ‰éˆ• -->
<button id="commentFab" onclick="scrollToComments()">ğŸ’¬</button>

<script>
const lessons = [
  {
    title: "åŸå¸‚æ–‡åŒ–èˆ‡ç”Ÿæ´»",
    meta: "ç¤¾æœƒ / æ–‡åŒ– Â· 800â€“1000 å­—",
    icon: "ğŸ“˜",
    fullUrl: "https://example.com/lesson1.pdf",
    warmup: ["ä½ æœ€å–œæ­¡åŸå¸‚çš„å“ªå€‹éƒ¨åˆ†ï¼Ÿ"],
    reading: ["ä½œè€…å¦‚ä½•æè¿°åŸå¸‚æ–‡åŒ–ï¼Ÿ"],
    discussion: ["åŸå¸‚ç”Ÿæ´»æœ€å¤§çš„æŒ‘æˆ°æ˜¯ä»€éº¼ï¼Ÿ"],
    vocab: ["urban","culture","community","identity","tradition"]
  },
  {
    title: "åœ‹éš›æ–°èè½åŠ›ç·´ç¿’",
    meta: "åœ‹éš› / è»äº‹ Â· 1000â€“1200 å­—",
    icon: "ğŸ§",
    fullUrl: "https://example.com/lesson2.pdf",
    warmup: ["ä½ å¾å“ªè£¡ç²å¾—åœ‹éš›æ–°èï¼Ÿ"],
    reading: ["æ–°èä¸»é¡Œæ˜¯ä»€éº¼ï¼Ÿ"],
    discussion: ["åª’é«”æ˜¯å¦å½±éŸ¿è§€é»ï¼Ÿ"],
    vocab: ["global","conflict","policy","summit","broadcast"]
  }
];

let filteredLessons = lessons;
let currentLessonId = null;

/* ===== æœå°‹ ===== */
function handleSearch() {
  const keyword = document.getElementById("keyword").value.trim();
  filteredLessons = lessons.filter(l =>
    keyword === "" || l.title.includes(keyword)
  );
  render();
}

/* ===== ä¸»ç•«é¢ ===== */
function render() {
  const list = document.getElementById("lesson-list");
  list.innerHTML = "";
  filteredLessons.forEach((l, id) => {
    list.innerHTML += `
      <div class="lesson-card">
        <div class="lesson-icon">${l.icon}</div>
        <div class="lesson-title">${l.title}</div>
        <div class="lesson-meta">${l.meta}</div>
        <button onclick="openPreview(${id})">é è¦½</button>
      </div>
    `;
  });
}

/* ===== é è¦½ ===== */
function openPreview(id) {
  const l = lessons[id];
  currentLessonId = id;
  modalTitle.innerText = l.title;
  modalMeta.innerText = l.meta;
  fill("modalWarmup", l.warmup);
  fill("modalReading", l.reading);
  fill("modalDiscussion", l.discussion);
  fill("modalVocab", l.vocab);
  readFullBtn.onclick = () => window.open(l.fullUrl);
  renderComments(id);
  previewModal.style.display = "flex";
}

function closePreview() {
  previewModal.style.display = "none";
}

function fill(id, arr) {
  const ul = document.getElementById(id);
  ul.innerHTML = "";
  arr.forEach(i => ul.innerHTML += `<li>${i}</li>`);
}

/* ===== ç•™è¨€ ===== */
function getComments(id) {
  return JSON.parse(localStorage.getItem("comments-" + id)) || [];
}

function saveComments(id, data) {
  localStorage.setItem("comments-" + id, JSON.stringify(data));
}

function renderComments(id) {
  const list = document.getElementById("commentList");
  list.innerHTML = "";
  getComments(id).forEach(c => {
    list.innerHTML += `<li>${c.text}<div style="font-size:11px;color:#888;">${c.time}</div></li>`;
  });
}

function addComment() {
  const input = commentInput.value.trim();
  if (!input) return;
  const data = getComments(currentLessonId);
  data.push({ text: input, time: new Date().toLocaleString() });
  saveComments(currentLessonId, data);
  commentInput.value = "";
  renderComments(currentLessonId);
}

function scrollToComments() {
  commentSection.scrollIntoView({ behavior: "smooth" });
}

render();
</script>

</body>
</html>
